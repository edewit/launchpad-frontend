<div class="container-fluid">
  <span *ngFor="let error of currentGui.messages">
  <div class="alert alert-{{error.severity == 'ERROR' ? 'danger' : 'warning'}} alert-dismissable" *ngIf="!error.showError">
    <button id="alert-close" type="button" class="close" data-dismiss="alert" aria-hidden="true" (click)="closeAlert(error)">
      <span class="pficon pficon-close"></span>
  </button>
  <span class="pficon pficon-error-circle-o"></span> {{error.description}}
</div>
</span>
<step [steps]="currentGui.state.steps" [stepIndex]="currentGui.stepIndex" (onclick)="gotoStep($event)"></step>
<form class="form-horizontal" #wizard="ngForm">
  <deploy [submittedGuis]="history" [command]="command" *ngIf="currentGui.results">
  </deploy>
  <div class="wizard-pf-loading blank-slate-pf" *ngIf="!currentGui.inputs">
    <div class="spinner spinner-lg blank-slate-pf-icon"></div>
    <h3 class="blank-slate-pf-main-action">Loading Wizard</h3>
    <p class="blank-slate-pf-secondary-action">
      The wizard is loading the initial screen...
    </p>
  </div>
  <div *ngIf="currentGui.stepIndex == 2 && history.get(1) && history.get(1).inputs[0].value != 'ZIP File' && !keycloak.isAuthenticated()">
    <div class="blank-slate-pf ">
      <h1>
        To continue, please log into or register an account for free<br />
        with the Red Hat Developer Program.
      </h1>
      <div class="blank-slate-pf-main-action">
        <button class="btn btn-primary btn-lg" (click)="keycloak.login()">Log in or register</button>
      </div>
    </div>
  </div>

  <deployment [gui]="currentGui" *ngIf="currentGui.metadata && currentGui.metadata.name == 'Deployment type'"></deployment>
  <mission [gui]="currentGui" *ngIf="currentGui.metadata && currentGui.metadata.name == 'Mission'"></mission>
  <runtime [gui]="currentGui" *ngIf="currentGui.metadata && currentGui.metadata.name == 'Runtime'"></runtime>

  <div style="padding-top: 3em" *ngIf="!(currentGui.stepIndex == 2 && history.get(1) && history.get(1).inputs[0].value != 'ZIP File' && !keycloak.isAuthenticated())">
    <div class="col-sm-offset-1" style="margin-bottom: 2.2em" [innerHTML]="currentGui.metadata.intro" *ngIf="currentGui.inputs && currentGui.metadata"></div>
    <div class="col-sm-offset-2 col-sm-10" style="position: absolute;margin-top: -2em; width: 50%" *ngIf="validation">
      <span class="spinner spinner-xs spinner-inline" *ngIf="validation"></span>Validating form...
    </div>
    <div class="form-group" [class.has-error]="messageForInput(input.name)" [class.required]="input.required" *ngFor="let input of currentGui.inputs">
      <la-input name="{{input.name}}" [ngModel]="input" (ngModelChange)="validate(form)" [messages]="currentGui.messages"></la-input>
    </div>
  </div>

  <div class="form-group" *ngIf="!currentGui.results && currentGui.stepIndex != 1">
    <div class="col-sm-offset-10 col-sm-2">
      <button id="back" type="button" class="btn btn-default" [disabled]="!currentGui.state.canMoveToPreviousStep" (click)="previous()">
        <span class="i fa fa-angle-left"></span>
        Back
      </button>
      <button id="next" type="button" class="btn btn-primary" [disabled]="!currentGui.state.canMoveToNextStep && !currentGui.state.canExecute || validation || (currentGui.stepIndex == 2 && history.get(1) && history.get(1).inputs[0].value != 'ZIP File' && !keycloak.isAuthenticated()) "
        (click)="next()">
        Next
        <span class="i fa fa-angle-right"></span>
      </button>
    </div>
  </div>
</form>
</div>